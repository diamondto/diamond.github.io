<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
    
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
  <title>
    Webpack学习笔记 |  爱产品，爱前端！
  </title>
  <meta name="generator" content="hexo-theme-yilia-plus">
  
  <link rel="shortcut icon" href="/favicon.ico" />
  
  
<link rel="stylesheet" href="../../../../css/style.css">

  
<script src="../../../../js/pace.min.js"></script>


  

  

<link rel="alternate" href="atom.xml" title="爱产品，爱前端！" type="application/atom+xml">
</head>

</html>

<body>
  <div id="app">
    <main class="content">
      <section class="outer">
  <article id="post-webpack学习笔记" class="article article-type-post" itemscope
  itemprop="blogPost" data-scroll-reveal>

  <div class="article-inner">
    
    <header class="article-header">
       
<h1 class="article-title sea-center" style="border-left:0" itemprop="name">
  Webpack学习笔记
</h1>
  

    </header>
    

    
    <div class="article-meta">
      <a href="" class="article-date">
  <time datetime="2020-01-14T16:00:00.000Z" itemprop="datePublished">2020-01-15</time>
</a>
      
  <div class="article-category">
    <a class="article-category-link" href="../../../../categories/%E6%89%93%E6%80%AA%E5%8D%87%E7%BA%A7Webpack/">打怪升级Webpack</a>
  </div>

      
      
<div class="word_count">
    <span class="post-time">
        <span class="post-meta-item-icon">
            <i class="ri-quill-pen-line"></i>
            <span class="post-meta-item-text"> 字数统计:</span>
            <span class="post-count">6.2k字</span>
        </span>
    </span>

    <span class="post-time">
        &nbsp; | &nbsp;
        <span class="post-meta-item-icon">
            <i class="ri-book-open-line"></i>
            <span class="post-meta-item-text"> 阅读时长≈</span>
            <span class="post-count">27分钟</span>
        </span>
    </span>
</div>

      
    </div>
    

    
    
    <div class="tocbot"></div>





    

    
    <div class="article-entry" itemprop="articleBody">
      


      

      
      <p>Welcome to share creative thoughts!</p>
<p>本质上，webpack 是一个现代 JavaScript 应用程序的静态模块打包器(module bundler)。当 webpack 处理应用程序时，它会递归地构建一个依赖关系图(dependency graph)，其中包含应用程序需要的每个模块，然后将所有这些模块打包成一个或多个 bundle。</p>
<h2 id="四个核心概念："><a href="#四个核心概念：" class="headerlink" title="四个核心概念："></a>四个核心概念：</h2><p>入口(entry)<br>输出(output)<br>loader：实现非js文件的打包，比如css, img, html等，通过loader功能<br>插件(plugins)：有效地打包压缩css/img/html等文件<br>loader和plugins配合使用。</p>
<p>更多👉：官方文档</p>
<h2 id="1-全局安装"><a href="#1-全局安装" class="headerlink" title="1.全局安装"></a>1.全局安装</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">npm/cnpm install webpack -g</span><br><span class="line">npm/cnpm install webpack-cli -g</span><br><span class="line">或者</span><br><span class="line">npm/cnpm install webpack webpack-cli -g</span><br></pre></td></tr></table></figure>

<h2 id="2-项目初始化，生成package-json"><a href="#2-项目初始化，生成package-json" class="headerlink" title="2. 项目初始化，生成package.json"></a>2. 项目初始化，生成package.json</h2><p>进入项目目录project_dir<br>执行npm init，一路回车，默认即可<br>项目文件夹下，会生成文件夹node_modules和文件package.json</p>
<h2 id="3-局部安装"><a href="#3-局部安装" class="headerlink" title="3. 局部安装"></a>3. 局部安装</h2><p>在项目目录下打开cmd<br>执行命令：<br>npm/cnpm install webpack webpack-cli -S</p>
<h2 id="4-打包测试"><a href="#4-打包测试" class="headerlink" title="4. 打包测试"></a>4. 打包测试</h2><p>webpack4打包命令为：webpack</p>
<p>D:\wpack&gt;webpack<br>默认entry：src/index.js</p>
<p>默认output：dist/main.js</p>
<p>默认打包模式为生成环境production</p>
<p>开发模式（不压缩格式）：webpack –mode development</p>
<p>生产模式（压缩格式）：webpack –mode production</p>
<h2 id="5-基本配置-webpack-config-js"><a href="#5-基本配置-webpack-config-js" class="headerlink" title="5. 基本配置: webpack.config.js"></a>5. 基本配置: webpack.config.js</h2><p>5.1 webpack.config.js配置</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    mode: <span class="string">"production"</span>, <span class="comment">// 两种模式：production和development，默认prodcution</span></span><br><span class="line">    entry: <span class="string">'./src/index.js'</span>,</span><br><span class="line">    output: &#123;</span><br><span class="line">        path: path.resolve(__dirname, <span class="string">'dist'</span>),</span><br><span class="line">        filename: <span class="string">'main.js'</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>其中，mode模式设置，亦可在package.json中设置，选一种方法即可。</p>
<p>5.2 package.json配置</p>
<p>在package.json文件中可以进行一些配置，比如：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">"scripts"</span>: &#123;</span><br><span class="line">  <span class="string">"test"</span>: <span class="string">"echo \"Error: no test specified\" &amp;&amp; exit 1"</span>,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>配置为如下：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"> <span class="string">"scripts"</span>: &#123;</span><br><span class="line">        <span class="comment">// test等脚本名字随意自定义</span></span><br><span class="line">        <span class="string">"test"</span>: <span class="string">"echo \"Error: no test specified\" &amp;&amp; exit 1"</span>,</span><br><span class="line">        <span class="comment">// 定义一个build脚本，指定config文件名称，可以更改配置文件的名字，例如改为webpack.config.my.js</span></span><br><span class="line">        <span class="string">"build"</span>: <span class="string">"webpack --config webpack.config.js"</span></span><br><span class="line">        <span class="comment">// mode设置，webpack.config.js中设置过mode后，此处可不用重复设置</span></span><br><span class="line">        <span class="string">"start"</span>: <span class="string">"webpack --mode development"</span>,</span><br><span class="line">  &#125;</span><br><span class="line">执行脚本：</span><br><span class="line"></span><br><span class="line">npm run build</span><br></pre></td></tr></table></figure>

<h2 id="6-安装本地服务器（dev-server）："><a href="#6-安装本地服务器（dev-server）：" class="headerlink" title="6 安装本地服务器（dev-server）："></a>6 安装本地服务器（dev-server）：</h2><p>在项目目录下执行命令：npm/cnpm install webpack-dev-server -S</p>
<p>webpack.config.js中相关配置：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    entry: <span class="string">'./src/index.js'</span>,</span><br><span class="line">    output: &#123;</span><br><span class="line">        path: path.resolve(__dirname, <span class="string">'dist'</span>),</span><br><span class="line">        filename: <span class="string">'main2.js'</span></span><br><span class="line">    &#125;,</span><br></pre></td></tr></table></figure>
<pre><code>// 配置dev-server</code></pre><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">    devServer: &#123;</span><br><span class="line">        contentBase:<span class="string">"./dist"</span>,</span><br><span class="line">        <span class="comment">// 本地服务器打包后文件保存路径</span></span><br><span class="line">        inline:<span class="literal">true</span>,</span><br><span class="line">        <span class="comment">// 实时刷新开启</span></span><br><span class="line">        port: <span class="number">3000</span>,</span><br><span class="line">        <span class="comment">// 端口设置</span></span><br><span class="line">        progress: <span class="literal">true</span>,</span><br><span class="line">        <span class="comment">// 打包进度条开启</span></span><br><span class="line">        compress: <span class="literal">true</span>,</span><br><span class="line">        <span class="comment">// 启动压缩</span></span><br><span class="line">        open: <span class="literal">true</span>,</span><br><span class="line">        <span class="comment">// 自动打开浏览器</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>devServer中还有很多配置项目，如port端口等。</p>
<p><strong>package.json中相关配置：</strong>添加dev脚本，通过执行npm run dev实现自动打开浏览器并在更新js文件后自动刷新浏览器</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">"scripts"</span>: &#123;</span><br><span class="line">     <span class="string">"test"</span>: <span class="string">"echo \"Error: no test specified\" &amp;&amp; exit 1"</span>,</span><br><span class="line">     <span class="string">"build"</span>: <span class="string">"webpack --config webpack.config.js"</span>,</span><br><span class="line">     <span class="string">"start"</span>: <span class="string">"webpack --mode development"</span>,</span><br><span class="line">     <span class="comment">// 定义一个dev脚本，启动服务器</span></span><br><span class="line">     <span class="string">"dev"</span>: <span class="string">"webpack-dev-server --open --inline"</span></span><br><span class="line"> &#125;,</span><br></pre></td></tr></table></figure>

<p>dev脚本说明：</p>
<p>webpack-dev-server：”启动webpack本地服务器”<br>–open: “自动打开浏览器”<br>–inline: “更新js后实时刷新浏览器”<br>注：总结：模块打包机，分析项目结构，找到JS模块和一些浏览器不能直接运行的拓展语言  scss  typescript，并将其打包为合适的格式给浏览器使用.优化产出，解析JS的模块，以当前的JS为准，查找所有相关的依赖文件，把文件打包成一个文件，解决了require问题。目录是dist<br>命令是npx webpack<br>手动配置，webpage.config.js<br>webpack是node写出来 的,自己配置入口和出口，路劲必须是绝对路径<br>path.resolve可以把相对路径解析成绝对路径</p>
<h2 id="7-loader配置"><a href="#7-loader配置" class="headerlink" title="7. loader配置"></a>7. loader配置</h2><p>7.1 测试无loader时的打包</p>
<p>首先在/src下创建一个style.css文件，然后在入口文件index.js中引入，方法如下：</p>
<p>import ‘./style.css’;<br>保存后，dev-server自动打包并刷新，但会报错，如下：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">Version: webpack <span class="number">4.41</span><span class="number">.2</span></span><br><span class="line">Time: <span class="number">28</span>ms</span><br><span class="line">Built at: <span class="number">2019</span><span class="number">-12</span><span class="number">-15</span> <span class="number">3</span>:<span class="number">04</span>:<span class="number">36</span> PM</span><br><span class="line">   Asset     Size  Chunks             Chunk Names</span><br><span class="line">main2.js  <span class="number">366</span> KiB    main  [emitted]  main</span><br><span class="line">Entrypoint main = main2.js</span><br><span class="line">[./src/index.js] <span class="number">200</span> bytes &#123;main&#125; [built]</span><br><span class="line">[./src/style.css] <span class="number">274</span> bytes &#123;main&#125; [built] [failed] [<span class="number">1</span> error]</span><br><span class="line">    + <span class="number">32</span> hidden modules</span><br><span class="line"></span><br><span class="line">ERROR <span class="keyword">in</span> ./src/style.css <span class="number">1</span>:<span class="number">4</span></span><br><span class="line">Module parse failed: Unexpected token (<span class="number">1</span>:<span class="number">4</span>)</span><br><span class="line">You may need an appropriate loader to handle <span class="keyword">this</span> file type, currently no loaders are configured to process <span class="keyword">this</span> file. See https:<span class="comment">//webpack.js.org/concepts#loaders</span></span><br><span class="line">&gt; body&#123;</span><br><span class="line">|     background-color: orange;</span><br><span class="line">| &#125;</span><br><span class="line"> @ ./src/index.js <span class="number">6</span>:<span class="number">0</span><span class="number">-21</span></span><br><span class="line">i ｢wdm｣: Failed to compile.</span><br><span class="line">原因为：没有相应的loader。</span><br></pre></td></tr></table></figure>

<p>7.2 配置loader</p>
<p>根据loader列表，找到对应的loader并下载安装（注意在项目目录下）。</p>
<p>安装常用的loader：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cnpm install style-loader css-loader -S</span><br><span class="line">cnpm install less less-loader -S</span><br><span class="line">cnpm install file-loader -S</span><br><span class="line">配置webpack.config.js：</span><br></pre></td></tr></table></figure>



<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">devServer: &#123;</span><br><span class="line">       contentBase:<span class="string">"./dist"</span>,</span><br><span class="line">       <span class="comment">// 本地服务器路径</span></span><br><span class="line">       inline:<span class="literal">true</span>,</span><br><span class="line">       <span class="comment">// 实时刷新开启</span></span><br><span class="line">   &#125;,</span><br><span class="line">   <span class="built_in">module</span>: &#123;</span><br><span class="line">       rules: [</span><br><span class="line">           <span class="comment">// 配置打包css文件的loader，use定义使用到的loader，注意顺序</span></span><br><span class="line">         	&#123; <span class="attr">test</span>: <span class="regexp">/\.css$/</span>, <span class="attr">use</span>: [<span class="string">'style-loader'</span>, <span class="string">'css-loader'</span>] &#125;,</span><br><span class="line">           <span class="comment">// 配置图片的loader</span></span><br><span class="line">           &#123; <span class="attr">test</span>: <span class="regexp">/\.(jpg|png|jpeg)$/</span>, <span class="attr">use</span>: [<span class="string">'file-loader'</span>] &#125;</span><br><span class="line">           <span class="comment">// 根据需要配置其他文件的loader</span></span><br><span class="line">       ]</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>

<p>注意：style-loader必须放在css-loader前面，执行有顺序（链式传递），否则报错。<br>从上到下、从右至左，顺序执行。<br>bundle是打包后的结果<br>bundle.js是一个匿名自执行函数，默认执行会传入一个对象，key  value<br>当前模块的路径是key   value函数是对象，对象中找到名字，call传入当前模块，require的返回结果就是模块的导出，把解析的所有模块变成一个对象，通过入口加载，依次去递归实现依赖关系。<br>入口文件，检查一下是不是在缓存中，安装模块，<br>dev:server:可以配置端口，加进度条progress<br>contentbase:找到文件夹<br>实现静态服务，npm run dev<br>插件：<br>打包后叫bundle.js<br>HTMLWebpackPlugin<br>yarn add<br>插件是一个数组，放着所有的插件<br>先new 一下，告诉模板和打包后的名字 npm run dev<br>哈希戳，在minify里面配置<br>hash可以产生新的时间标志，文件有更改，每次打包都不一样防止覆盖，加hash指定位数。<br>默认只认定JS模块， 模块解析失败  需要loader处理CSS模块<br>把源代码转换，转化成一个模块，配置module<br>找到以CSS结尾的，写正则，写个规则数组，去匹配不同的文件，<br>匹配CSS，/.css$/<br>css-loader 接续@import<br>style-loader  把CSS插入到head的标签中<br><strong>loader单一职责，多个loader需要数组，有顺序 的，默认从右向左，从下到上执行，先CSS再插入  loader还可以写成对象的方式，对象可以多传参数</strong><br>less-loader  style-loader<br>options里面可以写配置参数，写插入的位置<br>less-loader把less-&gt;css<br>yarn add less-loader<br>sass stylus sass-loader<br><strong>插件没有顺序<br>单独抽离文件 mini-css-extract-plugin</strong><br>插件都是类，new一下，写上名字<br>post-css-loader<br>插件有:mini -css-extract-plugin<br>optimize-css-assets-webpack-plugin<br>sourcemap源码映射</p>
<p>rule的另一种丰富配置：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&#123; <span class="attr">test</span>: <span class="regexp">/\.(css|less)$/</span>, <span class="attr">use</span>: [</span><br><span class="line">                &#123;</span><br><span class="line">                    loader: <span class="string">"style-loader"</span>,</span><br><span class="line">                    options: &#123;</span><br><span class="line">						<span class="comment">// 此处可以进行其他设置</span></span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;,</span><br><span class="line">                    <span class="string">'css-loader'</span>, <span class="comment">// 解析@import路径</span></span><br><span class="line">                    <span class="string">'less-loader'</span> <span class="comment">// 把less解析为css</span></span><br><span class="line">                ]</span><br><span class="line">            &#125;,</span><br><span class="line">如上rule的执行顺序为：less-loader &gt; css-loader &gt; style-loader &gt; options</span><br></pre></td></tr></table></figure>

<h2 id="8-插件plugins"><a href="#8-插件plugins" class="headerlink" title="8. 插件plugins"></a>8. 插件plugins</h2><p>插件在webpack.config.js中不区分顺序。</p>
<p>8.1 Html文件处理</p>
<p>，打包html文件，安装插件（注意在项目目录下安装）：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">cnpm install html-webpack-plugin -S</span><br><span class="line">配置webpack.config.js：</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>);</span><br><span class="line"><span class="keyword">const</span> HtmlWebpackPlugin = <span class="built_in">require</span>(<span class="string">"html-webpack-plugin"</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// ...</span></span><br><span class="line"></span><br><span class="line">	<span class="built_in">module</span>: &#123;</span><br><span class="line">        rules: [</span><br><span class="line">            <span class="comment">// 配置loader</span></span><br><span class="line">            &#123; <span class="attr">test</span>: <span class="regexp">/\.css$/</span>, <span class="attr">use</span>: [<span class="string">'style-loader'</span>, <span class="string">'css-loader'</span>] &#125;,</span><br><span class="line">            &#123; <span class="attr">test</span>: <span class="regexp">/\.(jpg|png|jpeg)$/</span>, <span class="attr">use</span>: [<span class="string">'file-loader'</span>] &#125;</span><br><span class="line">        ]</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// 配置插件</span></span><br><span class="line">    plugins: [</span><br><span class="line">        <span class="keyword">new</span> HtmlWebpackPlugin(&#123;</span><br><span class="line">            template: <span class="string">"./src/index.html"</span>, <span class="comment">// 打包前的html文件</span></span><br><span class="line">            filename: <span class="string">"index.html"</span>, <span class="comment">// 打包后的html文件名</span></span><br><span class="line">            minify: &#123;</span><br><span class="line">                removeAttributeQuotes: <span class="literal">true</span>, <span class="comment">// 去除引号</span></span><br><span class="line">                removeComments: <span class="literal">true</span>, <span class="comment">// 去除注意</span></span><br><span class="line">                removeEmptyAttributes: <span class="literal">true</span>,<span class="comment">// 去除空属性</span></span><br><span class="line">                collapseWhitespace: <span class="literal">true</span> <span class="comment">// 去除空格</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    ]</span><br></pre></td></tr></table></figure>

<p>8.2 样式抽离</p>
<p>安装抽离css插件：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">cnpm install --save-dev mini-css-extract-plugin</span><br><span class="line">配置webpack.config.js：</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>);</span><br><span class="line"><span class="keyword">const</span> HtmlWebpackPlugin = <span class="built_in">require</span>(<span class="string">"html-webpack-plugin"</span>);</span><br><span class="line"><span class="keyword">const</span> MiniCssExtractPlugin = <span class="built_in">require</span>(<span class="string">"mini-css-extract-plugin"</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// ...</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">// 方法三： 使用抽离</span></span><br><span class="line">            &#123; <span class="attr">test</span>: <span class="regexp">/\.css$/</span>, <span class="attr">use</span>: [</span><br><span class="line">                    MiniCssExtractPlugin.loader,</span><br><span class="line">                    <span class="string">'css-loader'</span>, <span class="comment">// 解析@import路径</span></span><br><span class="line">                ]</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123; <span class="attr">test</span>: <span class="regexp">/\.less$/</span>, <span class="attr">use</span>: [</span><br><span class="line">                    MiniCssExtractPlugin.loader,</span><br><span class="line">                    <span class="string">'css-loader'</span>, <span class="comment">// 解析@import路径</span></span><br><span class="line">                    <span class="string">'less-loader'</span> <span class="comment">// 把less解析为css</span></span><br><span class="line">                ]</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123; <span class="attr">test</span>: <span class="regexp">/\.(jpg|png|jpeg)$/</span>, <span class="attr">use</span>: [<span class="string">'file-loader'</span>] &#125;</span><br><span class="line"><span class="comment">// ...</span></span><br><span class="line"></span><br><span class="line">    plugins: [</span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">        <span class="comment">// 添加css抽离插件</span></span><br><span class="line">        <span class="keyword">new</span> MiniCssExtractPlugin(&#123;</span><br><span class="line">            filename: <span class="string">"main.css"</span>, <span class="comment">// 设置文件，css抽离为main.css文件中</span></span><br><span class="line">        &#125;)</span><br><span class="line">    ]</span><br></pre></td></tr></table></figure>

<p>抽离出的main.css没有被压缩，需安装插件：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cnpm install --save-dev terser-webpack-plugin <span class="comment">// 压缩js</span></span><br><span class="line">cnpm install --save-dev optimize-css-assets-webpack-plugin  <span class="comment">// 压缩抽离的css</span></span><br><span class="line">注意：以上两个插件需配合使用，同时配置，如只配置css插件，则js不会被压缩。</span><br></pre></td></tr></table></figure>

<p>并配置：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>);</span><br><span class="line"><span class="keyword">const</span> HtmlWebpackPlugin = <span class="built_in">require</span>(<span class="string">"html-webpack-plugin"</span>);</span><br><span class="line"><span class="keyword">const</span> MiniCssExtractPlugin = <span class="built_in">require</span>(<span class="string">"mini-css-extract-plugin"</span>);</span><br><span class="line"><span class="keyword">const</span> TerserJSPlugin = <span class="built_in">require</span>(<span class="string">"terser-webpack-plugin"</span>);</span><br><span class="line"><span class="keyword">const</span> OptimizeCSSAssetsPlugin = <span class="built_in">require</span>(<span class="string">"optimize-css-assets-webpack-plugin"</span>);</span><br><span class="line"><span class="comment">// 此处省略...</span></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    mode: <span class="string">"production"</span>, <span class="comment">//此处必须设置为production模式，否则抽离的css文件不会被压缩</span></span><br><span class="line">    <span class="comment">// 此处省略...</span></span><br><span class="line">    optimization: &#123; <span class="comment">// 优化项</span></span><br><span class="line">        minimizer: [</span><br><span class="line">            <span class="comment">// 同时实现js文件的压缩，与css抽离压缩插件同时配合使用，替代uglify</span></span><br><span class="line">            <span class="keyword">new</span> TerserJSPlugin(&#123;&#125;),</span><br><span class="line">            <span class="comment">// 压缩抽离后的css文件，此优化仅在production模式有效，development模式下不压缩</span></span><br><span class="line">            <span class="keyword">new</span> OptimizeCSSAssetsPlugin(&#123;&#125;)</span><br><span class="line">        ]</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="built_in">module</span>:&#123;</span><br><span class="line">        <span class="comment">// 此处省略...</span></span><br><span class="line">    &#125;,</span><br><span class="line">    plugins:&#123;</span><br><span class="line">        <span class="comment">// 此处省略...</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">优化项配置完成后，抽离的css文件和js文件即可正常同时被压缩。</span><br></pre></td></tr></table></figure>

<h2 id="9-JS语法转化"><a href="#9-JS语法转化" class="headerlink" title="9. JS语法转化"></a>9. JS语法转化</h2><p>使用babel模块。<br>安装基础loader：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">npm install -D babel-loader @babel/core @babel/preset-env webpack</span><br><span class="line">安装转化<span class="class"><span class="keyword">class</span>定义的对象的<span class="title">loader</span>：</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"><span class="title">npm</span> <span class="title">install</span> --<span class="title">save</span>-<span class="title">dev</span> @<span class="title">babel</span>/<span class="title">plugin</span>-<span class="title">proposal</span>-<span class="title">class</span>-<span class="title">properties</span></span></span><br><span class="line"><span class="class">安装转化装饰器用法的<span class="title">loader</span>：</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"><span class="title">npm</span> <span class="title">install</span> --<span class="title">save</span>-<span class="title">dev</span> @<span class="title">babel</span>/<span class="title">plugin</span>-<span class="title">proposal</span>-<span class="title">decorators</span></span></span><br><span class="line"><span class="class">配置<span class="title">webpack</span>.<span class="title">config</span>.<span class="title">js</span>：</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class">// 此处省略...</span></span><br><span class="line"><span class="class"><span class="title">module</span>.<span class="title">exports</span> </span>= &#123;</span><br><span class="line"><span class="comment">// 此处省略...</span></span><br><span class="line">    rules: [</span><br><span class="line">            <span class="comment">// 此处省略...</span></span><br><span class="line">            <span class="comment">// js语法转化</span></span><br><span class="line">            &#123;<span class="attr">test</span>: <span class="regexp">/\.js$/</span>, <span class="attr">use</span>: &#123;</span><br><span class="line">                loader: <span class="string">'babel-loader'</span>,</span><br><span class="line">                options: &#123;</span><br><span class="line">                  presets: [<span class="string">'@babel/preset-env'</span>],</span><br><span class="line">                  plugins: [  <span class="comment">// 参考文档配置</span></span><br><span class="line">                      <span class="comment">// '@babel/plugin-proposal-object-rest-spread',</span></span><br><span class="line">                      [<span class="string">"@babel/plugin-proposal-decorators"</span>, &#123; <span class="string">"legacy"</span>: <span class="literal">true</span> &#125;],</span><br><span class="line">                      [<span class="string">"@babel/plugin-proposal-class-properties"</span>, &#123; <span class="string">"loose"</span> : <span class="literal">true</span> &#125;]</span><br><span class="line">                  ]</span><br><span class="line">                &#125;</span><br><span class="line">              &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        ]</span><br><span class="line">&#125;</span><br><span class="line">如有需要其他babel-loader，可通过官网查找安装并配置。</span><br></pre></td></tr></table></figure>
<p>转化ES6语法<br>babel转换JS转成ES5 核心模块可以转换源代码<br>yarn add babel-loader @babel/core  @babel/preset-env  转化JS语法<br>promise也不会转化，要安装babel代码运行的包<br>@Babel/plugin-transform-runtime<br>@Babel-polyfill<br>js语法校验器：ESLint   校验语法规范<br>yarn add eslint eslint-loader   自己选择公司需要的环境和规则，下载json 文件放到配置中<br>enforce:”pre”   可以强制改变执行顺序</p>
<h2 id="10-图片处理"><a href="#10-图片处理" class="headerlink" title="10. 图片处理"></a>10. 图片处理</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>&gt; 在js中创建图片来引入:</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> bgimg <span class="keyword">from</span> <span class="string">'./2.png'</span>; <span class="comment">// 引入图片并返回新的图片地址</span></span><br><span class="line"><span class="keyword">let</span> image = <span class="keyword">new</span> Image();</span><br><span class="line"><span class="built_in">console</span>.log(image);</span><br><span class="line">image.src = bgimg;</span><br><span class="line"><span class="built_in">document</span>.body.appendChild(image);</span><br><span class="line"><span class="number">2</span>&gt; 在CSS中引入图片:</span><br><span class="line"></span><br><span class="line">body&#123;</span><br><span class="line">    background-color: yellow;</span><br><span class="line">    background-image: url(<span class="string">"2.png"</span>);</span><br><span class="line">&#125;</span><br><span class="line">div&#123;</span><br><span class="line">    background-image: url(<span class="string">'./1.jpg'</span>);</span><br><span class="line">    width: <span class="number">500</span>px;</span><br><span class="line">    height: <span class="number">700</span>px;</span><br><span class="line">&#125;</span><br><span class="line">然后由js导入：</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">'./style.css'</span>;</span><br><span class="line"><span class="number">3</span>&gt; html中img标签引入图片：</span><br><span class="line"></span><br><span class="line">&#123; <span class="attr">test</span>: <span class="regexp">/\.(jpg|png|jpeg)$/</span>, <span class="attr">use</span>: &#123;</span><br><span class="line">                loader: <span class="string">'file-loader'</span>,</span><br><span class="line">                options:&#123;</span><br><span class="line">                    esModule: <span class="literal">false</span>, <span class="comment">// 此处必须加，否则无法压缩图片路径</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125; &#125;,</span><br><span class="line">            &#123; <span class="attr">test</span>: <span class="regexp">/\.html$/</span>, <span class="attr">use</span>: &#123;</span><br><span class="line">                loader: <span class="string">'html-loader'</span>,</span><br><span class="line">                options: &#123;</span><br><span class="line">                    attrs: [<span class="string">':src'</span>, <span class="string">':data-src'</span>],</span><br><span class="line">                    minimize:<span class="literal">true</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125; &#125;,</span><br><span class="line">            <span class="comment">// &#123; test: /\.html$/, use: 'html-withimg-loader' &#125;,</span></span><br></pre></td></tr></table></figure>

<h2 id="11-指定路径"><a href="#11-指定路径" class="headerlink" title="11. 指定路径"></a>11. 指定路径</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>&gt; 单独位img路径添加域名前缀：</span><br><span class="line"></span><br><span class="line">&#123; <span class="attr">test</span>: <span class="regexp">/\.(jpg|png|jpeg)$/</span>, <span class="attr">use</span>: &#123;</span><br><span class="line">                loader: <span class="string">'file-loader'</span>,</span><br><span class="line">                options:&#123;</span><br><span class="line">                    esModule: <span class="literal">false</span>,</span><br><span class="line">                    outputPath: <span class="string">'/img/'</span>,  <span class="comment">// 存放在img文件夹下</span></span><br><span class="line">                    publicPath: <span class="string">'htpp://localhost'</span> <span class="comment">// 路径前添加域名，此时/img/文件夹失效；</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125; &#125;,</span><br><span class="line">故，其他文件可进行类似单独设置。 <span class="number">2</span>&gt; 为img/css/js等文件统一添加域名前缀：</span><br><span class="line"></span><br><span class="line">    entry: <span class="string">'./src/index.js'</span>,</span><br><span class="line">    output: &#123;</span><br><span class="line">        path: path.resolve(__dirname, <span class="string">'dist'</span>),</span><br><span class="line">        filename: <span class="string">'bundle-[hash:8].js'</span>,  <span class="comment">// bundle-[hash].js 给文件名增加hash值,[hash:8]显示前8位</span></span><br><span class="line">        publicPath: <span class="string">'http://localhost'</span>  <span class="comment">// 为所有路径添加域名前缀</span></span><br><span class="line">    &#125;,</span><br></pre></td></tr></table></figure>

<p>3&gt;为css指定存放文件夹：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">plugins: [</span><br><span class="line">      <span class="keyword">new</span> MiniCssExtractPlugin(&#123;</span><br><span class="line">          filename: <span class="string">"css/main.css"</span>, <span class="comment">// css抽离为main.css文件中,并存放只dist/css文件夹下</span></span><br><span class="line">      &#125;)</span><br><span class="line">  ]</span><br></pre></td></tr></table></figure>

<h2 id="12-多页面打包"><a href="#12-多页面打包" class="headerlink" title="12. 多页面打包"></a>12. 多页面打包</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>&gt; 多入口entry、多出口output设置：</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 单入口</span></span><br><span class="line">    <span class="comment">// entry: './src/index.js',</span></span><br><span class="line">    <span class="comment">// 多入口</span></span><br><span class="line">    entry: &#123;</span><br><span class="line">        home: <span class="string">'./src/index.js'</span>,</span><br><span class="line">        other: <span class="string">'./src/other.js'</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// 对应多出口</span></span><br><span class="line">    output: &#123;</span><br><span class="line">        <span class="comment">// 单出口设置</span></span><br><span class="line">        <span class="comment">// filename: 'bundle-[hash:8].js',  // bundle-[hash].js 给文件名增加hash值,[hash:8]显示前8位</span></span><br><span class="line">        <span class="comment">// path: path.resolve(__dirname, 'dist'),</span></span><br><span class="line">        <span class="comment">// 多出口设置, [name]代表多入口变量名home,other，逐一打包</span></span><br><span class="line">        filename: <span class="string">'[name].js'</span>, <span class="comment">// 仍可以加hash值</span></span><br><span class="line">        path: path.resolve(__dirname, <span class="string">'dist'</span>),</span><br><span class="line">        <span class="comment">// publicPath: 'http://localhost'</span></span><br><span class="line">    &#125;,</span><br></pre></td></tr></table></figure>

<p>2&gt; html-webpack-plugin设置：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">plugins: [</span><br><span class="line">        <span class="keyword">new</span> HtmlWebpackPlugin(&#123;</span><br><span class="line">            template: <span class="string">"./index.html"</span>,</span><br><span class="line">            filename: <span class="string">"index.html"</span>,</span><br><span class="line">            chunks: [<span class="string">'home'</span>], <span class="comment">// 多页面打包设置，对应入口js</span></span><br><span class="line">        &#125;),</span><br><span class="line">        <span class="comment">// 多页面打包，多个new，单页面可以引入多个入口js</span></span><br><span class="line">        <span class="keyword">new</span> HtmlWebpackPlugin(&#123;</span><br><span class="line">            template: <span class="string">"./other.html"</span>,</span><br><span class="line">            filename: <span class="string">"other.html"</span>,</span><br><span class="line">            chunks: [<span class="string">'other'</span>, <span class="string">'home'</span>], <span class="comment">// 多页面打包设置，对应入口js, 先引入home再other</span></span><br><span class="line">        &#125;),</span><br><span class="line">    ]</span><br></pre></td></tr></table></figure>

<h2 id="13-配置source-map"><a href="#13-配置source-map" class="headerlink" title="13. 配置source-map"></a>13. 配置source-map</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">tips：source-map会明显增加打包时间。 需要安装的包： @babel/core @babel/preset-env babel-loader webpack-dev-server 设置：</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    entry: &#123;</span><br><span class="line">        home: <span class="string">'./src/index.js'</span>,</span><br><span class="line">        other: <span class="string">'./src/other.js'</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// 对应多出口</span></span><br><span class="line">    output: &#123;</span><br><span class="line">        filename: <span class="string">'[name].js'</span>,</span><br><span class="line">        path: path.resolve(__dirname, <span class="string">'dist'</span>),</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 1）源码映射，单独生成一个sourcemap文件，出错时会直接提示报错行</span></span><br><span class="line">    <span class="comment">// devtool: 'source-map', // 大而全的设置</span></span><br><span class="line">    <span class="comment">// 2）源码映射，不会产生单独的文件，单会直接显示错误的行列</span></span><br><span class="line">    <span class="comment">// devtool: 'eval-source-map',</span></span><br><span class="line">    <span class="comment">// 3) 不会产生列，但是会生成一个单独的映射文件</span></span><br><span class="line">    <span class="comment">// devtool: 'cheap-module-source-map', // 产生后可以保留起来</span></span><br><span class="line">    <span class="comment">// 4) 不会产生文件，集成再打包后的文件中，也不会产生列</span></span><br><span class="line">    devtool: <span class="string">'cheap-module-source-map'</span>, <span class="comment">// 产生后可以保留起来</span></span><br><span class="line">&#125;</span><br><span class="line">ps：以上<span class="number">4</span>个方法貌似都生成map文件了</span><br></pre></td></tr></table></figure>

<h2 id="14-watch实时打包"><a href="#14-watch实时打包" class="headerlink" title="14. watch实时打包"></a>14. watch实时打包</h2><p>希望实时打包，开启监控，<br>设置如下：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    devtool: <span class="string">'cheap-module-source-map'</span>, <span class="comment">// 产生后可以保留起来</span></span><br><span class="line">    <span class="comment">// 开启监控，实时打包设置</span></span><br><span class="line">    watch: <span class="literal">true</span>,<span class="comment">//</span></span><br><span class="line">    watchOptions:&#123; <span class="comment">// 设置监控选项</span></span><br><span class="line">        poll: <span class="number">1000</span>, <span class="comment">// 每秒查询1000次，我需要更新吗？</span></span><br><span class="line">        aggregateTimeout: <span class="number">500</span>, <span class="comment">// 防抖，ctrl+s后多久开始打包  500 MS内我输入的代码只打包一次</span></span><br><span class="line">        ignored: <span class="regexp">/node_modules/</span>, <span class="comment">// 忽略不需要监控的文件夹，不用监控</span></span><br><span class="line">    &#125;,</span><br><span class="line">    devServer: &#123;&#125;<span class="comment">//</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="15-常用插件（3个）"><a href="#15-常用插件（3个）" class="headerlink" title="15. 常用插件（3个）"></a>15. 常用插件（3个）</h2><p>安装：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">cnpm install --save-dev clean-webpack-plugin</span><br><span class="line">cnpm install --save-dev copy-webpack-plugin</span><br><span class="line">cleanwebpackPlugin -- 打包前清除dist目录</span><br><span class="line">copywebpackPlugin -- copy目录中的文件到指定目录</span><br><span class="line">bannerPlugin -- 版权声明插件，webpack内部插件，无需安装 引入：</span><br><span class="line"><span class="keyword">const</span> &#123;CleanWebpackPlugin&#125; = <span class="built_in">require</span>(<span class="string">"clean-webpack-plugin"</span>);</span><br><span class="line"><span class="keyword">const</span> CopyWebpackPlugin = <span class="built_in">require</span>(<span class="string">"copy-webpack-plugin"</span>);</span><br><span class="line"><span class="keyword">const</span> webpack = <span class="built_in">require</span>(<span class="string">"webpack"</span>); <span class="comment">// 内置bannerPlugin插件</span></span><br><span class="line"></span><br><span class="line">plugins:[</span><br><span class="line">    <span class="keyword">new</span> CleanWebpackPlugin(), <span class="comment">// 先删除dist目录再打包，不用填参数</span></span><br><span class="line">    <span class="keyword">new</span> CopyWebpackPlugin([ <span class="comment">// 可以设置多组from to</span></span><br><span class="line">        &#123;<span class="attr">from</span>:<span class="string">'doc'</span>, <span class="attr">to</span>:<span class="string">'./'</span>&#125;</span><br><span class="line">    ]),</span><br><span class="line">    <span class="keyword">new</span> webpack.BannerPlugin(<span class="string">"Make 2019 by Hanoso"</span>), <span class="comment">// 声明版权信息</span></span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<p>ps：常用插件可以根据需要自行决定安装~</p>
<h2 id="16-webpack跨域问题"><a href="#16-webpack跨域问题" class="headerlink" title="16. webpack跨域问题"></a>16. webpack跨域问题</h2><p>跨域：请求端和响应端域名/端口不一致，即为跨域。 默认访问的路径<a href="http://localhost:8081" target="_blank" rel="noopener">http://localhost:8081</a> webpack-dev-serer服务路径 =&gt; 服务器端口3000端口 –&gt;跨域</p>
<p>1） 方法一：配置代理</p>
<p>首先在项目根目录创建server.js服务端文件；<br>配置devServer代理；</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">在index.js中配置Ajax请求响应。</span><br><span class="line"><span class="comment">// server.js</span></span><br><span class="line"><span class="comment">// express</span></span><br><span class="line"><span class="keyword">let</span> express = <span class="built_in">require</span>(<span class="string">"express"</span>);   <span class="comment">// 引入express，默认会启用服务</span></span><br><span class="line"><span class="keyword">let</span> app = express(); <span class="comment">// 创建app服务，让express执行</span></span><br><span class="line"><span class="comment">// /api/user, /test/user，请求路径中的mock被替换为空</span></span><br><span class="line">app.get(<span class="string">'/user'</span>,(req,res)=&gt;&#123; <span class="comment">// 写接口，请求req响应res，get请求路径/user，回调函数</span></span><br><span class="line">    res.json(&#123;<span class="attr">name</span>:<span class="string">'Hanoso666'</span>&#125;) <span class="comment">// 返回的响应json</span></span><br><span class="line">&#125;)</span><br><span class="line">app.listen(<span class="number">3000</span>); <span class="comment">// 监听3000端口</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// webpack.config.js</span></span><br><span class="line">devServer&#123;</span><br><span class="line">            <span class="comment">// 配置代理</span></span><br><span class="line">        proxy:&#123;</span><br><span class="line">            <span class="string">'/api'</span>: &#123;</span><br><span class="line">                <span class="comment">// webpack默认首页打开未8081端口，配置target转至3000端口，与</span></span><br><span class="line">                <span class="comment">// server.js端口保持一致，从而解决跨域问题</span></span><br><span class="line">                target: <span class="string">'http://localhost:3000'</span>,<span class="comment">//告诉去3000找API的user</span></span><br><span class="line">                pathRewrite: &#123;<span class="string">'^/api'</span>:<span class="string">''</span>&#125;, <span class="comment">// 将请求路径中开头/api替换为空，通过重写的方法把请求代理到express服务器上，前提是有服务器。</span></span><br><span class="line">                <span class="comment">// 请求端路径/api/user，实际情况不确定，可以有很多写法，如/test/user, /new/user等等，为避免重复设置，可将前端请求路径统一以/mock开头，如/mock/api/user, /mock/test/user, /mock/new/user, 然后将/mock替换为空，server.js中去掉/mock</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// index.js</span></span><br><span class="line"><span class="keyword">let</span> xhr = <span class="keyword">new</span> XMLHttpRequest(); <span class="comment">// 创建Ajax对象</span></span><br><span class="line">xhr.open(<span class="string">'GET'</span>,<span class="string">'/api/user'</span>,<span class="literal">true</span>); <span class="comment">// 建立GET请求 指定方法，路径，是否异步  /mock/api/user, /mock/test/user</span></span><br><span class="line">xhr.onload = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(xhr.response); <span class="comment">// 设置回调，处理结果</span></span><br><span class="line">&#125;</span><br><span class="line">xhr.send(); <span class="comment">// 发送Ajax请求</span></span><br><span class="line">结果：启动dev和server.js后，访问http:<span class="comment">//localhost:8081即可经代理实现server.js响应，8081是webpack-dev-server的服务</span></span><br><span class="line">但是不在一个端口，要配置代理proxy。</span><br></pre></td></tr></table></figure>

<p>2）方法二：当前端只想单纯模拟数据时，不需要写server.js，只模拟前端数据 在devServer中设置：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// webpack.cofig.js</span></span><br><span class="line">devServer&#123;</span><br><span class="line">        before(app)&#123; <span class="comment">// 内部的提供方法，钩子</span></span><br><span class="line">            app.get(<span class="string">'/user'</span>,(req,res)=&gt;&#123; <span class="comment">// 路径与index.js请求路径一致即可</span></span><br><span class="line">                res.json(&#123;<span class="attr">name</span>:<span class="string">'Hanoso2020'</span>&#125;)</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// index.js</span></span><br><span class="line"><span class="comment">// express</span></span><br><span class="line"><span class="keyword">let</span> xhr = <span class="keyword">new</span> XMLHttpRequest(); <span class="comment">// 创建Ajax对象</span></span><br><span class="line">xhr.open(<span class="string">'GET'</span>,<span class="string">'/api/user'</span>,<span class="literal">true</span>); <span class="comment">// 建立GET请求 /mock/api/user, /mock/test/user</span></span><br><span class="line">xhr.onload = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(xhr.response); <span class="comment">// 设置回调</span></span><br><span class="line">&#125;</span><br><span class="line">xhr.send(); <span class="comment">// 发送Ajax请求</span></span><br></pre></td></tr></table></figure>

<p>3）方法三：有服务端，不用代理来处理，能不能在服务端启动webpack? webpack就是一个模块<br>采用中间件 就可以！ 仅在server.js中配置，先通过webpack拿到配置对象，产生编译对象 ，扔给中间件。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> express = <span class="built_in">require</span>(<span class="string">"express"</span>);</span><br><span class="line"><span class="keyword">let</span> app = express();</span><br><span class="line"><span class="keyword">let</span> webpack = <span class="built_in">require</span>(<span class="string">'webpack'</span>);</span><br><span class="line"><span class="comment">// 中间件</span></span><br><span class="line"><span class="keyword">let</span> middle = <span class="built_in">require</span>(<span class="string">'webpack-dev-middleware'</span>);</span><br><span class="line"><span class="keyword">let</span> config = <span class="built_in">require</span>(<span class="string">'./webpack.config.js'</span>);<span class="comment">//拿到配置对象</span></span><br><span class="line"><span class="keyword">let</span> compailer = webpack(config); <span class="comment">// 启动server.js时启动webpack，由服务器端启动前端，处理配置文件，返回编译后的结果</span></span><br><span class="line"></span><br><span class="line">app.use(middle(compailer));<span class="comment">//加载中间件</span></span><br><span class="line"></span><br><span class="line">app.get(<span class="string">'/user'</span>,(req,res)=&gt;&#123;</span><br><span class="line">    res.json(&#123;<span class="attr">name</span>:<span class="string">'Hanoso-middle'</span>&#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.listen(<span class="number">3000</span>);  <span class="comment">// 端口可按需配置</span></span><br><span class="line">通过访问localhost:<span class="number">300</span>/user打开网页，即可实现数据打印&#123;<span class="string">"name"</span>:<span class="string">"Hanoso-middle"</span>&#125;，即设置成功。</span><br></pre></td></tr></table></figure>

<h2 id="17-resolve解析第三方包"><a href="#17-resolve解析第三方包" class="headerlink" title="17. resolve解析第三方包"></a>17. resolve解析第三方包</h2><p>示例代码：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span>.modules&#123;</span><br><span class="line">    resolve:&#123; <span class="comment">// 解析第三方包</span></span><br><span class="line">        modules:[path.resolve(<span class="string">'node_modules'</span>)],</span><br><span class="line">        extensions:[<span class="string">'.js'</span>,<span class="string">'.css'</span>,<span class="string">'.json'</span>,<span class="string">'.vue'</span>], <span class="comment">// 限定扩展名，按序依次解析</span></span><br><span class="line">        mainFields:[<span class="string">'style'</span>,<span class="string">'main'</span>,<span class="string">'index'</span>], <span class="comment">// 入口文件的名字 index.js</span></span><br><span class="line">        alias:&#123; <span class="comment">// 设置别名，在index.js引入时可直接采用 import 'bootstrap'</span></span><br><span class="line">            bootstrap:<span class="string">'bootstrap/dist/css/bootstrap.css'</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="18-配置环境变量"><a href="#18-配置环境变量" class="headerlink" title="18. 配置环境变量"></a>18. 配置环境变量</h2><p>示例代码：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// webpack.config.js</span></span><br><span class="line">    plugins: [</span><br><span class="line">        <span class="keyword">new</span> webpack.DefinePlugin(&#123;</span><br><span class="line">            DEV:<span class="built_in">JSON</span>.stringify(<span class="string">'dev'</span>), <span class="comment">// 字符串判断</span></span><br><span class="line">            FLAG:<span class="string">'true'</span>,  <span class="comment">// 此处也仅为演示，布尔判断</span></span><br><span class="line">            EXPRESSION:<span class="string">'1+1'</span>,</span><br><span class="line">            <span class="comment">// EXPRESSION:JSON.stringify('1+1'),  // 不加JSON.stringify，会打印出1+1.加上则打印2，此处仅作演示</span></span><br><span class="line">        &#125;),</span><br><span class="line">    ]</span><br><span class="line"><span class="comment">// index.js</span></span><br><span class="line"><span class="comment">// 环境变量配置</span></span><br><span class="line"><span class="keyword">let</span> url=<span class="string">""</span>;</span><br><span class="line"><span class="keyword">if</span>(DEV == <span class="string">'dev'</span>)&#123;</span><br><span class="line">    url = <span class="string">'http://localhost:8081'</span></span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    url = <span class="string">'http://www.baidu.com'</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(DEV);</span><br><span class="line"><span class="built_in">console</span>.log(EXPRESSION);</span><br><span class="line"><span class="built_in">console</span>.log(url);</span><br></pre></td></tr></table></figure>

<h2 id="19-区分不同环境变量（环境继承）"><a href="#19-区分不同环境变量（环境继承）" class="headerlink" title="19. 区分不同环境变量（环境继承）"></a>19. 区分不同环境变量（环境继承）</h2><p>需安装插件：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">cnpm i --save-dev webpack-merge</span><br><span class="line"><span class="number">1</span>&gt; 创建基础配置文件webpack.base.js； <span class="number">2</span>&gt; 创建开发环境配置文件webpack.dev.js； <span class="number">3</span>&gt; 创建生产环境配置文件webpack.pro.js； 通过webpack-merge可以实现不同环境配置文件与基础配置文件的继承/覆盖。 示例代码如下：</span><br><span class="line"></span><br><span class="line"><span class="comment">// webpack.base.js 配置基础信息</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// webpack.dev.js 配置开发环境信息</span></span><br><span class="line"><span class="keyword">let</span> &#123;smart&#125; = <span class="built_in">require</span>(<span class="string">'webpack-merge'</span>);</span><br><span class="line"><span class="keyword">let</span> base = <span class="built_in">require</span>(<span class="string">'./webpack.base.js'</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = smart(base,&#123;</span><br><span class="line">    mode: <span class="string">'development'</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// webpack.pro.js 配置生产环境信息</span></span><br><span class="line"><span class="keyword">let</span> &#123;smart&#125; = <span class="built_in">require</span>(<span class="string">'webpack-merge'</span>);</span><br><span class="line"><span class="keyword">let</span> base = <span class="built_in">require</span>(<span class="string">'./webpack.base.js'</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = smart(base,&#123;</span><br><span class="line">    mode: <span class="string">'production'</span></span><br><span class="line">&#125;)</span><br><span class="line">如开启不同环境，可执行如下代码： npm run build -- --config webpack.pro.js 亦可设置package.json文件：</span><br><span class="line"></span><br><span class="line"><span class="string">"scripts"</span>: &#123;</span><br><span class="line">    <span class="string">"build"</span>: <span class="string">"webpack --config webpack.config.js"</span>,</span><br><span class="line">    <span class="string">"b-dev"</span>: <span class="string">"webpack --config webpack.dev.js"</span>,</span><br><span class="line">    <span class="string">"b-pro"</span>: <span class="string">"webpack --config webpack.pro.js"</span>,</span><br><span class="line">    <span class="string">"wds"</span>: <span class="string">"webpack-dev-server"</span>,</span><br><span class="line">    <span class="string">"server"</span>: <span class="string">"node server.js"</span></span><br><span class="line">  &#125;,</span><br><span class="line">通过以下命令启动相应环境：npm run b-dev 或 npm run b-pro。</span><br></pre></td></tr></table></figure>

<h2 id="20-优化项"><a href="#20-优化项" class="headerlink" title="20. 优化项"></a>20. 优化项</h2><p>noParse<br>功能：不去解析包（如jQuery）中的依赖库。 需配置config。</p>
<p>exclude或include<br>功能：排除或指定查找路径/文件夹，配置其一即可。 需配置config。</p>
<p>moment时间插件及IgnorePlugin<br>功能：格式化时间，时间计算等，可以设置语言。 安装：cnpm i –save-dev moment</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 时间插件moment</span></span><br><span class="line"><span class="keyword">import</span> moment <span class="keyword">from</span> <span class="string">'moment'</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">'moment/locale/zh-cn'</span>; <span class="comment">// 仅引入中文包</span></span><br><span class="line">moment.locale(<span class="string">'zh-cn'</span>); <span class="comment">// 设置语言</span></span><br><span class="line"><span class="keyword">let</span> r = moment().endOf(<span class="string">'day'</span>).fromNow();</span><br><span class="line"><span class="built_in">console</span>.log(r);</span><br><span class="line">需配置config。</span><br></pre></td></tr></table></figure>

<p>happypack多线程打包模块<br>安装：cnpm i –save-dev happypack，cnpm i –save-dev @babel/preset-react 多线程打包输出如下：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">Happy[css]: Version: <span class="number">5.0</span><span class="number">.1</span>. Threads: <span class="number">3</span></span><br><span class="line">i ｢wds｣: Project is running at http:<span class="comment">//localhost:8081/</span></span><br><span class="line">i ｢wds｣: webpack output is served <span class="keyword">from</span> /</span><br><span class="line">i ｢wds｣: Content not <span class="keyword">from</span> webpack is served <span class="keyword">from</span> ./dist</span><br><span class="line">Happy[css]: All <span class="keyword">set</span>; signaling webpack to proceed.</span><br><span class="line">Happy[js]: Version: 5.0.1. Threads: 3</span><br><span class="line">Happy[js]: All <span class="keyword">set</span>; signaling webpack to proceed.</span><br><span class="line">i ｢wdm｣: Hash: 7b2804c8263a364b7bf0</span><br><span class="line">Version: webpack 4.41.4</span><br><span class="line">Time: 2572ms</span><br><span class="line">Built at: 2019-12-21 10:31:04 PM</span><br><span class="line">需配置config。</span><br></pre></td></tr></table></figure>

<p>webpack自带优化（tree-shaking + scope hosting）<br><strong>tree-shaking：采用import引入 生产环境下，把没用的到的代码 自动删除掉；</strong><br><strong>scope hosting：作用域提升，webpack打包时 自动简化 省略中间代码；</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// index.js中</span></span><br><span class="line"><span class="comment">// webpack自带优化功能 测试</span></span><br><span class="line"><span class="keyword">import</span> calc <span class="keyword">from</span> <span class="string">'./test'</span></span><br><span class="line"><span class="built_in">console</span>.log(calc.sum(<span class="number">1</span>,<span class="number">2</span>));<span class="comment">//要换成calc.default.sum</span></span><br><span class="line"><span class="comment">// import 在生产环境下 可以自动去掉用不到的代码</span></span><br><span class="line"><span class="comment">// tree-shaking 把没用的到的代码 自动删除掉</span></span><br><span class="line"><span class="comment">// let calc = require('./test')</span></span><br><span class="line"><span class="comment">// console.log(calc.default.sum(1,2)); // 采用require方式，sum在default中</span></span><br><span class="line"><span class="comment">// ES6 模块会把结果放到default中</span></span><br><span class="line"><span class="comment">// require 不支持tree-shaking,引入不能像import一样在生产环境下去除多余代码，故推荐使用import引入</span></span><br><span class="line"><span class="comment">// scope hosting 作用域提升</span></span><br><span class="line"><span class="keyword">let</span> a = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">let</span> b = <span class="number">2</span>;</span><br><span class="line"><span class="keyword">let</span> c = <span class="number">3</span>;</span><br><span class="line"><span class="keyword">let</span> d = a + b + c;</span><br><span class="line"><span class="built_in">console</span>.log(d, <span class="string">'--------------------'</span>) <span class="comment">// webpack打包时 自动简化 省略中间代码，返回最终结果</span></span><br><span class="line">抽离公共代码【导致其他问题】</span><br><span class="line">位置：optimization &#123; <span class="attr">splitChunks</span>:&#123;...&#125; &#125;</span><br><span class="line">问题：添加splitChunks配置后，会影响js/css等文件的打包，浏览器无效果。</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// index.js中示例代码：</span></span><br><span class="line"><span class="comment">// 抽离公共代码 测试</span></span><br><span class="line"><span class="comment">// console.log('抽离公共代码 测试')//是为了缓存，提高加载速度，切换页面时缓存公共的页面部分样式。</span></span><br><span class="line"><span class="comment">// import './a.js'</span></span><br><span class="line"><span class="comment">// import './b.js'</span></span><br><span class="line"><span class="comment">// console.log('./index.js')</span></span><br><span class="line"><span class="comment">// import jquery from 'jquery';</span></span><br><span class="line"><span class="comment">// console.log(jquery)</span></span><br></pre></td></tr></table></figure>
<p>需配置config，跟单入口，单出口的文件相比，entry现在是一个对象了，output 的 filename 多了一个 [name].。<br>最后执行打包命令，可以看到 dist 目录下面生成了 index.bundle.js 和 signup.bundle.js 。<br>所以这里的 [name] 等同于 entry 定义的键名。<br>适合多页面应用，缓存公共部分代码<br>当遇到诸多子功能模块时，全部打包在一起的话会有好几MB，所以最佳方式是进行多入口打包。<br>以下来自他人的项目建议：<br>首先，项目打包策略遵循以下几点原则：<br><strong>选择合适的打包粒度，生成的单文件大小不要超过500KB<br>   充分利用浏览器的并发请求，同时保证并发数不超过6<br>   尽可能让浏览器命中304，频繁改动的业务代码不要与公共代码打包<br>   避免加载太多用不到的代码，层级较深的页面进行异步加载</strong></p>
<blockquote>
<p>第三方库如vue、jquery、bootstrap打包为一个文件<br> 公共组件如弹窗、菜单等打包为一个文件<br> 工具类、项目通用基类打包为一个文件<br> 各个功能模块打包出自己的入口文件<br>  各功能模块作用一个SPA，子页面进行异步加载</p>
</blockquote>
<p><img src="https://img-blog.csdn.net/20180620225415604?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1N1cGVyX0xE/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="在这里插入图片描述"></p>
<h2 id="懒加载"><a href="#懒加载" class="headerlink" title="懒加载"></a>懒加载</h2><p>场景：播放音乐，点按钮再加载资源播放。<br>介绍：在js代码回调函数中import其他js文件，并获取其中的数据。</p>
<p>示例代码：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// source.js中</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="string">'lazy-load'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// index.js中</span></span><br><span class="line"><span class="comment">// 懒加载 测试</span></span><br><span class="line"><span class="keyword">let</span> button = <span class="built_in">document</span>.createElement(<span class="string">'button'</span>);<span class="comment">//绑定监听事件</span></span><br><span class="line">button.innerHTML = <span class="string">'Hello'</span>;</span><br><span class="line">button.addEventListener(<span class="string">'click'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">import</span>(<span class="string">'./source.js'</span>).then(<span class="function"><span class="params">data</span>=&gt;</span>&#123;  <span class="comment">// 回调函数中引入，路由懒加载的实现就是靠import语法</span></span><br><span class="line">    <span class="comment">//es6中的草案语法，jsonp实现动态加载文件</span></span><br><span class="line">        <span class="built_in">console</span>.log(data.default);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="built_in">document</span>.body.appendChild(button);</span><br></pre></td></tr></table></figure>

<h2 id="热更新"><a href="#热更新" class="headerlink" title="热更新"></a>热更新</h2><p>功能：局部更新修改的内容。每次更改页面只变一部分</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// index.js中</span></span><br><span class="line"><span class="comment">// 热更新 测试</span></span><br><span class="line"><span class="keyword">import</span> str <span class="keyword">from</span> <span class="string">'./source'</span>;<span class="comment">//</span></span><br><span class="line"><span class="built_in">console</span>.log(str);</span><br><span class="line"><span class="keyword">if</span>(<span class="built_in">module</span>.hot)&#123; <span class="comment">// 如果devServer中hot为true，则启动热更新</span></span><br><span class="line">    <span class="built_in">module</span>.hot.accept(<span class="string">'./source'</span>,()=&gt;&#123;<span class="comment">//若支持热更新</span></span><br><span class="line">        <span class="keyword">let</span> str = <span class="built_in">require</span>(<span class="string">'./source'</span>)</span><br><span class="line">        <span class="built_in">console</span>.log(str)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line">需配置config。</span><br></pre></td></tr></table></figure>

<p>以下为上述优化项在webpack.config.js中的配置：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> Happypack = <span class="built_in">require</span>(<span class="string">"happypack"</span>); <span class="comment">// 4）</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    devServer: &#123;</span><br><span class="line">        hot:<span class="literal">true</span>, <span class="comment">// </span></span><br><span class="line">    &#125;,</span><br><span class="line">    optimization: &#123; <span class="comment">// 优化项</span></span><br><span class="line">        minimizer: [ ],</span><br><span class="line">        <span class="comment">// splitChunks:&#123; // 分割代码块 6)</span></span><br><span class="line">        <span class="comment">//     cacheGroups:&#123; // 缓存组</span></span><br><span class="line">        <span class="comment">//         common:&#123; // 抽离 公共的模块</span></span><br><span class="line">        <span class="comment">//             chunks:'initial',</span></span><br><span class="line">        <span class="comment">//             minSize:0, // 最小大小</span></span><br><span class="line">        <span class="comment">//             minChunks:2, // 最小出现次数</span></span><br><span class="line">        <span class="comment">//         &#125;,</span></span><br><span class="line">        <span class="comment">//         vendor:&#123; // 抽离 第三方模块</span></span><br><span class="line">        <span class="comment">//             priority:1, // 权重高，优先抽离第三方模块，再抽离其他</span></span><br><span class="line">        <span class="comment">//             test:/node_modules/, // 要抽离出的文件</span></span><br><span class="line">        <span class="comment">//             chunks: 'initial',</span></span><br><span class="line">        <span class="comment">//             minSize:0,</span></span><br><span class="line">        <span class="comment">//             minChunks:2</span></span><br><span class="line">        <span class="comment">//         &#125;</span></span><br><span class="line">        <span class="comment">//     &#125;</span></span><br><span class="line">        <span class="comment">// &#125;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="built_in">module</span>: &#123;</span><br><span class="line">        noParse:<span class="regexp">/jquery/</span>, <span class="comment">// 排出不需要解析的包（没有其他依赖项的包）； 1)</span></span><br><span class="line">        rules: [</span><br><span class="line">            <span class="comment">// 优化：多线程打包css文件</span></span><br><span class="line">            &#123; <span class="attr">test</span>: <span class="regexp">/\.css$/</span>, <span class="attr">use</span>: <span class="string">'Happypack/loader?id=css'</span> &#125;,  <span class="comment">// 4)</span></span><br><span class="line">            <span class="comment">// ...</span></span><br><span class="line">            &#123;<span class="attr">test</span>: <span class="regexp">/\.js$/</span>, </span><br><span class="line">            <span class="comment">// exclude和include配置一个即可 2)</span></span><br><span class="line">            exclude:<span class="regexp">/node_modules/</span>,  <span class="comment">// 排除文件夹，不去该路径下查找</span></span><br><span class="line">            <span class="comment">// include:path.resolve('src'), // 指定文件夹，去该路径下查找</span></span><br><span class="line">            <span class="comment">// 使用happypack对js进行打包</span></span><br><span class="line">            use: <span class="string">'Happypack/loader?id=js'</span>  <span class="comment">// 4)</span></span><br><span class="line">            &#125;</span><br><span class="line">        ],</span><br><span class="line">    &#125;,</span><br><span class="line">    plugins: [</span><br><span class="line">        <span class="keyword">new</span> webpack.NamedModulesPlugin(), <span class="comment">// 打印更新的模块路径 8)</span></span><br><span class="line">        <span class="keyword">new</span> webpack.HotModuleReplacementPlugin(), <span class="comment">// 热更新插件 8)</span></span><br><span class="line">        <span class="keyword">new</span> Happypack(&#123; <span class="comment">// 多线程方式打包css文件 4)</span></span><br><span class="line">            id: <span class="string">'css'</span>,</span><br><span class="line">            use:[<span class="string">'style-loader'</span>,<span class="string">'css-loader'</span>]</span><br><span class="line">        &#125;),</span><br><span class="line">        <span class="keyword">new</span> Happypack(&#123; <span class="comment">// 多线程方式打包js文件 4)</span></span><br><span class="line">            id: <span class="string">'js'</span>,</span><br><span class="line">            use:[&#123;</span><br><span class="line">                loader: <span class="string">'babel-loader'</span>,</span><br><span class="line">                options:&#123;</span><br><span class="line">                    presets: [</span><br><span class="line">                        <span class="string">'@babel/preset-env'</span>,</span><br><span class="line">                        <span class="string">'@babel/preset-react'</span></span><br><span class="line">                    ],</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;]</span><br><span class="line">        &#125;),</span><br><span class="line">        <span class="keyword">new</span> webpack.IgnorePlugin(<span class="regexp">/\.\/locale/</span>, /moment/), <span class="comment">// 忽略moment插件中的locale模块 3)</span></span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





      
      <!-- reward -->
      
      <div id="reward-btn">
        打赏
      </div>
      
    </div>
    
    
      <!-- copyright -->
      
        <div class="declare">
          <ul class="post-copyright">
            <li>
              <i class="ri-copyright-line"></i>
              <strong>版权声明： </strong s>
              本博客所有文章除特别声明外，均采用 <a href="https://www.apache.org/licenses/LICENSE-2.0.html" rel="external nofollow"
                target="_blank">Apache License 2.0</a> 许可协议。转载请注明出处！
            </li>
          </ul>
        </div>
        
    <footer class="article-footer">
      
          
<div class="share-btn">
      <span class="share-sns share-outer">
        <i class="ri-share-forward-line"></i>
        分享
      </span>
      <div class="share-wrap">
        <i class="arrow"></i>
        <div class="share-icons">
          
          <a class="weibo share-sns" href="javascript:;" data-type="weibo">
            <i class="ri-weibo-fill"></i>
          </a>
          <a class="weixin share-sns wxFab" href="javascript:;" data-type="weixin">
            <i class="ri-wechat-fill"></i>
          </a>
          <a class="qq share-sns" href="javascript:;" data-type="qq">
            <i class="ri-qq-fill"></i>
          </a>
          <a class="douban share-sns" href="javascript:;" data-type="douban">
            <i class="ri-douban-line"></i>
          </a>
          <!-- <a class="qzone share-sns" href="javascript:;" data-type="qzone">
            <i class="icon icon-qzone"></i>
          </a> -->
          
          <a class="facebook share-sns" href="javascript:;" data-type="facebook">
            <i class="ri-facebook-circle-fill"></i>
          </a>
          <a class="twitter share-sns" href="javascript:;" data-type="twitter">
            <i class="ri-twitter-fill"></i>
          </a>
          <a class="google share-sns" href="javascript:;" data-type="google">
            <i class="ri-google-fill"></i>
          </a>
        </div>
      </div>
</div>

<div class="wx-share-modal">
    <a class="modal-close" href="javascript:;"><i class="ri-close-circle-line"></i></a>
    <p>扫一扫，分享到微信</p>
    <div class="wx-qrcode">
      <img src="//api.qrserver.com/v1/create-qr-code/?size=150x150&data=http://yoursite.com/2020/01/15/webpack%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" alt="微信分享二维码">
    </div>
</div>

<div id="share-mask"></div>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="../../../../tags/%E5%B7%A5%E5%85%B7%E7%B1%BB%E5%AD%A6%E4%B9%A0/" rel="tag">工具类学习</a></li></ul>


    </footer>

  </div>

  
  
  <nav class="article-nav">
    
      <a href="../../../02/17/React%E9%A1%B9%E7%9B%AE%E9%9C%80%E6%B1%82%E5%88%86%E6%9E%90/" class="article-nav-link">
        <strong class="article-nav-caption">上一篇</strong>
        <div class="article-nav-title">
          
            React项目需求分析
          
        </div>
      </a>
    
    
      <a href="../../../../2019/12/25/%E2%80%9C%E6%96%B0%E5%9F%BA%E5%BB%BA%E2%80%9D%E7%9A%84%E6%99%BA%E8%83%BD%E5%8C%96%E6%80%9D%E8%80%83/" class="article-nav-link">
        <strong class="article-nav-caption">下一篇</strong>
        <div class="article-nav-title">“新基建”的智能化思考</div>
      </a>
    
  </nav>


  

  
  
<!-- valine评论 -->
<div id="vcomments-box">
    <div id="vcomments">
    </div>
</div>
<script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
<script src='https://cdn.jsdelivr.net/npm/valine@1.3.10/dist/Valine.min.js'></script>
<script>
    new Valine({
        el: '#vcomments',
        app_id: '',
        app_key: '',
        path: window.location.pathname,
        notify: 'false',
        verify: 'false',
        avatar: 'mp',
        placeholder: '给我的文章加点评论吧~',
        recordIP: true
    });
    const infoEle = document.querySelector('#vcomments .info');
    if (infoEle && infoEle.childNodes && infoEle.childNodes.length > 0) {
        infoEle.childNodes.forEach(function (item) {
            item.parentNode.removeChild(item);
        });
    }
</script>
<style>
    #vcomments-box {
        padding: 5px 30px;
    }

    @media screen and (max-width: 800px) {
        #vcomments-box {
            padding: 5px 0px;
        }
    }

    #vcomments-box #vcomments {
        background-color: #fff;
    }

    .v .vlist .vcard .vh {
        padding-right: 20px;
    }

    .v .vlist .vcard {
        padding-left: 10px;
    }
</style>

  

  
  
  

</article>
</section>
      <footer class="footer">
  <div class="outer">
    <ul class="list-inline">
      <li>
        &copy;
        2020
        Wangqiuxia
      </li>
      <li>
        
        Powered by
        
        
        <a href="https://hexo.io" target="_blank">Hexo</a> Theme <a href="https://github.com/Shen-Yu/hexo-theme-ayer" target="_blank">Ayer</a>
        
      </li>
    </ul>
    <ul class="list-inline">
      <li>
        
        
        <span>
  <i>PV:<span id="busuanzi_value_page_pv"></span></i>
  <i>UV:<span id="busuanzi_value_site_uv"></span></i>
</span>
        
      </li>
      
      <li>
        <!-- cnzz统计 -->
        
        <script type="text/javascript" src='https://s9.cnzz.com/z_stat.php?id=1278069914&amp;web_id=1278069914'></script>
        
      </li>
    </ul>
  </div>
</footer>
      <div class="to_top">
        <div class="totop" id="totop">
  <i class="ri-arrow-up-line"></i>
</div>
      </div>
    </main>
    <aside class="sidebar">
      <button class="navbar-toggle"></button>
<nav class="navbar">
  
  <div class="logo">
    <a href="../../../../index.html"><img src="/images/ayer-side.svg" alt="爱产品，爱前端！"></a>
  </div>
  
  <ul class="nav nav-main">
    
    <li class="nav-item">
      <a class="nav-item-link" href="../../../../index.html">主页</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="../../../../archives">归档</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="../../../../categories">分类</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="../../../../tags">标签</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="../../../../tags/%E6%8A%80%E6%9C%AF/">小程序</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="../../../../http:/shenyu-vip.lofter.com">摄影</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="../../../../https:/v.xiumi.us/stage/v5/4IeLH/197507179">关于我</a>
    </li>
    
  </ul>
</nav>
<nav class="navbar navbar-bottom">
  <ul class="nav">
    <li class="nav-item">
      
      <a class="nav-item-link nav-item-search"  title="Search">
        <i class="ri-search-line"></i>
      </a>
      
      
      <a class="nav-item-link" target="_blank" href="../../../../atom.xml" title="RSS Feed">
        <i class="ri-rss-line"></i>
      </a>
      
    </li>
  </ul>
</nav>
<div class="search-form-wrap">
  <div class="local-search local-search-plugin">
  <input type="search" id="local-search-input" class="local-search-input" placeholder="Search...">
  <div id="local-search-result" class="local-search-result"></div>
</div>
</div>
    </aside>
    <div id="mask"></div>

<!-- #reward -->
<div id="reward">
  <span class="close"><i class="ri-close-line"></i></span>
  <p class="reward-p"><i class="ri-cup-line"></i>请我喝杯咖啡吧~</p>
  <div class="reward-box">
    
    <div class="reward-item">
      <img class="reward-img" src="../../../../images/alipay.jpg">
      <span class="reward-type">支付宝</span>
    </div>
    
    
    <div class="reward-item">
      <img class="reward-img" src="../../../../images/wechat.jpg">
      <span class="reward-type">微信</span>
    </div>
    
  </div>
</div>
    
<script src="../../../../js/jquery-2.0.3.min.js"></script>


<script src="../../../../js/jquery.justifiedGallery.min.js"></script>


<script src="../../../../js/lazyload.min.js"></script>


<script src="../../../../js/busuanzi-2.3.pure.min.js"></script>


<script src="../../../../js/share.js"></script>



<script src="../../../../fancybox/jquery.fancybox.min.js"></script>




<script>
  try {
    var typed = new Typed("#subtitle", {
    strings: ['做一个有情怀懂产品的程序媛！','业精于勤荒于嬉！行成于思毁于随！','越努力越幸运'],
    startDelay: 0,
    typeSpeed: 200,
    loop: true,
    backSpeed: 100,
    showCursor: true
    });
  } catch (err) {
  }
  
</script>




<script src="../../../../js/tocbot.min.js"></script>

<script>
  // Tocbot_v4.7.0  http://tscanlin.github.io/tocbot/
  tocbot.init({
    tocSelector: '.tocbot',
    contentSelector: '.article-entry',
    headingSelector: 'h1, h2, h3, h4, h5, h6',
    hasInnerContainers: true,
    scrollSmooth: true,
    scrollContainer:'main',
    positionFixedSelector: '.tocbot',
    positionFixedClass: 'is-position-fixed',
    fixedSidebarOffset: 'auto',
    onClick: (e) => {
      $('.toc-link').removeClass('is-active-link');
      $(`a[href=${e.target.hash}]`).addClass('is-active-link');
      $(e.target.hash).scrollIntoView();
      return false;
    }
  });
</script>


<script>
  var ayerConfig = {
    mathjax: false
  }
</script>


<script src="../../../../js/ayer.js"></script>


<script src="https://cdn.jsdelivr.net/npm/jquery-modal@0.9.2/jquery.modal.min.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jquery-modal@0.9.2/jquery.modal.min.css">


<!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" style="display:none" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.css">
<script src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"></script>

<script>
    function viewer_init() {
        let pswpElement = document.querySelectorAll('.pswp')[0];
        let $imgArr = document.querySelectorAll(('.article-entry img:not(.reward-img)'))

        $imgArr.forEach(($em, i) => {
            $em.onclick = () => {
                // slider展开状态
                // todo: 这样不好，后面改成状态
                if (document.querySelector('.left-col.show')) return
                let items = []
                $imgArr.forEach(($em2, i2) => {
                    let img = $em2.getAttribute('data-idx', i2)
                    let src = $em2.getAttribute('data-target') || $em2.getAttribute('src')
                    let title = $em2.getAttribute('alt')
                    // 获得原图尺寸
                    const image = new Image()
                    image.src = src
                    items.push({
                        src: src,
                        w: image.width || $em2.width,
                        h: image.height || $em2.height,
                        title: title
                    })
                })
                var gallery = new PhotoSwipe(pswpElement, PhotoSwipeUI_Default, items, {
                    index: parseInt(i)
                });
                gallery.init()
            }
        })
    }
    viewer_init()
</script>




<script type="text/javascript" src="https://js.users.51.la/20544303.js"></script>

    
    <div id="music">
    
    
    
    <iframe frameborder="no" border="1" marginwidth="0" marginheight="0" width="200" height="52"
        src="//music.163.com/outchain/player?type=2&id=518895142&auto=1&height=32"></iframe>
</div>

<style>
    #music {
        position: fixed;
        right: 15px;
        bottom: 0;
        z-index: 998;
    }
</style>
    
  </div>
</body>

</html>